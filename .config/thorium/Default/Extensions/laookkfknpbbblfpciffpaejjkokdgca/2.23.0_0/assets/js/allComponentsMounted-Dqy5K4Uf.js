import{n as t}from"./dynamic-import-helper-Gh3O-GNF.js";const e={data:()=>({componentsMounted:{}}),unreactive:()=>({uid:m.utils.shortId()}),beforeCreate(){const e=this.$options.components;Object.keys(e).forEach((o=>{const n=e[o];"function"==typeof n&&(e[o]=function(){this.$set(this.componentsMounted,o,!1);const e=`${o}:${this.uid}:mounted`,i=()=>this.componentsMounted[o]=!0;return t.$once(e,i),n(arguments).then((n=>{const s=n.default;return s&&s.doNotWaitForMount&&(this.$delete(this.componentsMounted,o),t.$off(e,i)),n}))}.bind(this))}))},created(){t.$on("widgets:timeoutExceeded",this.onWidgetTimeout)},mounted(){if(Object.keys(this.componentsMounted).length){const t=this.$watch("componentsMounted",(e=>{Object.values(e).every((t=>t))&&(this.onAllComponentsMounted(),t())}),{deep:!0,immediate:!0})}else this.onAllComponentsMounted()},destroyed(){this.stopListeningToWidgetTimeout()},methods:{stopListeningToWidgetTimeout(){t.$off("widgets:timeoutExceeded",this.onWidgetTimeout)},getContextUid(){return this.$vnode&&this.$vnode.context&&this.$vnode.context.uid||""},onAllComponentsMounted(){this.onAllComponentsMountedOverride?this.onAllComponentsMountedOverride():this.widgetId?m.widgetManager.appReady(this.widgetId):this.emitComponentMounted(),this.stopListeningToWidgetTimeout()},emitComponentMounted(){t.$emit(`${this.$options.name}:${this.getContextUid()}:mounted`)},onWidgetTimeout(){const t=Object.keys(this.componentsMounted).filter((t=>!this.componentsMounted[t]));t.length&&console.warn(`${this.$options.name} is awaiting ${t.join(", ")} to mount.`)}}};export{e as a};