import{G as e,c as t,an as s,a2 as i,q as o,n as r}from"./dynamic-import-helper-Gh3O-GNF.js";import a from"./AppPopup-kxasHFCt.js";import{A as n}from"./AppViewSwitchDynamic-DUaF00u2.js";import{u as l,S as p}from"./main-Diiwusn-.js";import{A as c}from"./AppView-D98wzsjm.js";import{A as u}from"./AppHeader-D7x6VYmc.js";import m from"./BaseIcon-CCkbWtl5.js";import{B as d}from"./BaseItemList-dKD1dgqB.js";import{u as b,a as w,S as h}from"./siteBlockerGroups-9WPnbAn4.js";import{T as g}from"./ToggleSwitch-BMo4SbmD.js";import{F as f}from"./FormEditableSpan-B3N16ueW.js";import{B as v}from"./BaseForm-CAbyV7zb.js";import{n as S}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{A as y}from"./AppLoading-DWsYUtJy.js";import k from"./siteBlockerSession-omvO_qAK.js";import{F as I}from"./FavIcon-DNJ6VCN3.js";import{f as C,c as A}from"./array-YYQw31d9.js";import{A as _}from"./AppEmpty-D1SMtbWh.js";import{d as B}from"./focusModeState-D4CLHiD7.js";import{A as j}from"./AppButtonRow-FcGvStaX.js";import{A as G}from"./AppActionBanner-BY1A1nUa.js";import{A as x}from"./AppHeaderControl-kJjUFX4q.js";import{B as R}from"./BaseDropdown-x2dYnnCF.js";import{B as D}from"./BaseDropdownOption-C6EewfIZ.js";import{A as W,a as V}from"./AppConfirmCancel-2_xBrO2S.js";import{c as N,a as P}from"./constants-BfBD_H-d.js";import"./main-DaaZyiXy.js";import"./Logger-DgjqecXr.js";import"./string-DLOjEt1Y.js";import"./ResizeSensor-ZXOsDHeC.js";import"./globalKeyEventManager-DTQSIy-h.js";import"./SmoothReflow-44YdkIfk.js";import"./allComponentsMounted-Dqy5K4Uf.js";import"./appViewSwitchMixin-BsLJ76Hr.js";import"./VueBase-CYtBAh2Z.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-CCjyjLnb.js";import"./portal-vue.esm-BTKM9g0x.js";import"./AppContainer-Dnf6Egvr.js";import"./showAnyway-iBeVTgqC.js";import"./reactiveCustomization-CaJFMm70.js";import"./appToggleMixin-DeAIUg7Z.js";import"./ViewState-CalcjAWV.js";import"./appZStack-CXXM5U-T.js";import"./AppDash-DkDer3J7.js";import"./icon-close-DRlspKs3.js";import"./constants-BpVlFj04.js";import"./index-C2sSf61p.js";import"./constants-Dqx3dGLK.js";import"./compareObjects-BF7sSNEf.js";import"./FormMessage-D8y-6rLo.js";import"./icon-alert-BikrS7AG.js";import"./LocalStorageStoreSyncedItem-CtVH-muf.js";import"./promisifiedChrome-YDDyAvDe.js";import"./focusModeViewState-B4fUYtwj.js";import"./focusModeHelpers-CbYS8k-X.js";import"./PomodoroTimers-CyrfcuWH.js";import"./persistStore-7VuxlznA.js";import"./pomodoroCompleted-PtbKLdeQ.js";import"./login-kENE0gaj.js";import"./authService-DSVbm6Rd.js";import"./auth-D2YAhF74.js";import"./legacyUserMigration-DJj0rzI-.js";import"./enums-Cgv4i8uw.js";import"./migrateLegacyUserMessageHandler-FH_m4diU.js";import"./onboarding-Bdvt2O8-.js";import"./modal-D5eTjgvI.js";import"./links-fallback-J-S_uhC9.js";import"./BaseDropdownContent-DpVJFI_8.js";import"./constants-CALDQiUE.js";import"./icon-ellipsis-D7nTOXaQ.js";const M=e({name:"SiteBlockerGroupsListItem",components:{BaseForm:v,FormEditableSpan:f,BaseIcon:m,ToggleSwitch:g},props:{group:{type:Object,required:!0},newGroup:{type:Boolean,default:!1}},setup:()=>({groupsStore:b(),viewStateStore:l(),inlineInputRef:t(),formRef:t(),capture:s("capture")}),mounted(){var e;this.newGroup&&(null==(e=this.inlineInputRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.group.enabled=!this.group.enabled,!this.newGroup)return null==(e=this.capture)||e.call(this,"site blocker toggle group",{defaultKey:this.group.defaultKey}),this.groupsStore.update(this.group.id,{enabled:this.group.enabled})},createNewGroup(){var e;if(this.newGroup)return this.group.validate(),this.groupsStore.clearActiveItem(),null==(e=this.capture)||e.call(this,"site blocker create new group",{defaultKey:this.group.defaultKey}),this.groupsStore.create(this.group)},async goToGroupWebsitesIfNotNewGroup(){var e;this.newGroup||(this.groupsStore.editItem(this.group.id),await(null==(e=this.viewStateStore)?void 0:e.setActiveView(p.Websites)))}}});const E=S(e({name:"SiteBlockerGroupsList",components:{BaseIcon:m,SiteBlockerGroupsListItem:S(M,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("li",{staticClass:"site-blocker-groups-list-item app-list-item-lines-between",attrs:{"data-test":"groups-list-item"},on:{click:e.goToGroupWebsitesIfNotNewGroup}},[t("base-form",{ref:"formRef",staticClass:"list-item-form",attrs:{submit:e.createNewGroup,"submit-button":!1,"submit-on-blur":!0}},[t("div",{staticClass:"list-item-content",class:{editing:e.newGroup}},[t("form-editable-span",{ref:"inlineInputRef",staticClass:"group-websites-input",attrs:{name:"name-input",editing:e.newGroup,placeholder:"New group","data-test":"groups-list-item-input"},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}}),e.newGroup?e._e():t("span",{staticClass:"group-websites-count"},[e._v(e._s(e.group.totalWebsites))]),t("toggle-switch",{attrs:{value:e.group.enabled,"data-test":"groups-list-item-toggle"},on:{click:function(t){return t.stopPropagation(),e.toggleEnabled.apply(null,arguments)}}}),t("div",{staticClass:"icon-wrapper group-websites-view u--mobile-show-bg",class:{disabled:e.newGroup},attrs:{"data-test":"groups-list-item-websites"}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-next",size:"10px"}})],1)],1)])],1)}),[],!1,null,"91a0f507").exports,BaseItemList:d},setup:()=>({groupsStore:b()}),computed:{editingExistingGroup(){return!!this.groupsStore.activeItem&&!!this.groupsStore.getGroupOrDefaultFromId(this.groupsStore.activeItem.id)}},methods:{createNewGroup(){this.groupsStore.newItem()}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-list"},[t("div",{staticClass:"groups-header"},[t("span",{staticClass:"groups-header-title"},[e._v("Blocked groups")]),t("div",{staticClass:"icon-wrapper",attrs:{"data-test":"new-group"},on:{click:e.createNewGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus",size:"12px"}})],1)]),t("base-item-list",[e.groupsStore.activeItem&&!e.editingExistingGroup?t("site-blocker-groups-list-item",{key:e.groupsStore.activeItem.id,attrs:{group:e.groupsStore.activeItem,"new-group":!0}}):e._e(),e._l(e.groupsStore.items,(function(e){return t("site-blocker-groups-list-item",{key:e.id,attrs:{group:e}})}))],2)],1)}),[],!1,null,"c9a82ea7").exports,O=e({name:"SiteBlockerGroupsBlockingBannerIcon",components:{FavIcon:I},props:{url:{type:String,required:!0}},setup:()=>({yDisplacement:"0rem",xDisplacement:"0rem",animationStart:"0s",animationSpeed:"10s"}),created(){this.yDisplacement=4*Math.random()-2+"rem",this.xDisplacement=2.25*Math.random()+1.5+"rem";const e=5*Math.random()+35;this.animationSpeed=e+"s",this.animationStart=-1*Math.random()*e+"s"}}),F=()=>{i(((e,t)=>({"99fb043a":e.xDisplacement,"201f1e6f":e.animationSpeed,"2020e28a":e.animationStart,bcf4f738:e.yDisplacement})))},L=O.setup;O.setup=L?(e,t)=>(F(),L(e,t)):F;const K=e({name:"SiteBlockerGroupsBlockingBanner",components:{SiteBlockerGroupsBlockingBannerIcon:S(O,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"site-blocker-groups-blocking-banner-icon"},[t("fav-icon",{staticClass:"favicon",attrs:{url:e.url}})],1)}),[],!1,null,"b6e1f749").exports,BaseIcon:m},setup:()=>({sessionStore:k(),iconRangeInterval:void 0}),data:()=>({visibleIconRangeMin:0,visibleIconRangeMax:0,iconsVisible:!1}),computed:{urls(){return""===this.sessionStore.urls?[]:this.sessionStore.urls.replaceAll("*","com").split(" ")}},watch:{urls(){this.setRandomIconRange()}},created(){this.setRandomIconRange(),this.iconRangeInterval=setInterval((()=>{this.visibleIconRangeMin=C(this.urls,this.visibleIconRangeMin,1),this.visibleIconRangeMax=C(this.urls,this.visibleIconRangeMax,1)}),5e3),setTimeout((()=>{this.iconsVisible=!0}),200)},destroyed(){clearInterval(this.iconRangeInterval)},methods:{setRandomIconRange(){const e=Math.floor(Math.random()*this.urls.length);this.visibleIconRangeMin=e,this.visibleIconRangeMax=C(this.urls,e,Math.min(this.urls.length-1,10))},isIconInRange(e){return this.visibleIconRangeMax<this.visibleIconRangeMin?e>=0&&e<=this.visibleIconRangeMax||e>=this.visibleIconRangeMin&&e<=this.urls.length-1:(e-this.visibleIconRangeMin)*(e-this.visibleIconRangeMax)<=0}}});const T=S(e({name:"SiteBlockerGroups",components:{AppActionBanner:G,AppButtonRow:j,AppEmpty:_,AppLoading:y,SiteBlockerGroupsBlockingBanner:S(K,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("transition-group",{staticClass:"site-blocker-groups-blocking-banner",attrs:{tag:"div",name:"slow-fade-icon"}},[t("div",{key:"blocking-browser",staticClass:"blocking-browser",attrs:{"data-test":"blocking-browser"}},[t("div",{staticClass:"blocking-nav"},[t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item"}),t("div",{staticClass:"nav-item nav-bar"})]),t("div",{staticClass:"blocking-viewport"},[t("base-icon",{attrs:{src:"icon/denied",size:"1.5rem"}}),t("span",{staticClass:"blocking-message"},[e._v("Blocking distractions")])],1)]),e._l(e.urls,(function(s,i){return e.iconsVisible&&e.isIconInRange(i)?t("site-blocker-groups-blocking-banner-icon",{key:`${s}`,attrs:{url:s}}):e._e()}))],2)}),[],!1,null,"27c10520").exports,SiteBlockerGroupsList:E,BaseIcon:m,AppHeader:u,AppView:c},setup:()=>({groupsStore:b(),websitesStore:w(),sessionStore:k(),capture:s("capture")}),computed:{loaded(){return this.groupsStore.loaded&&this.websitesStore.loaded},hasActiveItem(){return!!this.groupsStore.activeItem},empty(){return 0===this.groupsStore.items.length},focusModeActive:()=>B.currentValue,manualToggleControlsVisible(){return!this.focusModeActive&&!this.empty&&this.loaded}},created(){this.groupsStore.refresh(),this.websitesStore.refresh()},methods:{createNewGroup(){this.groupsStore.newItem()},async toggleBlockingActive(){var e;this.sessionStore.active||this.sessionStore.hasPermissions||await this.sessionStore.ensurePermissions(),this.sessionStore.toggleActive(),null==(e=this.capture)||e.call(this,"site blocker manual toggle active",{active:this.sessionStore.active})}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-groups",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("base-icon",{staticClass:"app-header-icon",attrs:{src:"icon/apps/site-blocker",size:"16px"}}),t("span",{staticClass:"app-header-name"},[e._v("Site Blocker")])]},proxy:!0}])}),e.sessionStore.featureEnabled&&!e.sessionStore.hasPermissions?t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}}):e._e(),e.sessionStore.featureEnabled||e.focusModeActive?e._e():t("app-action-banner",{attrs:{"action-text":"Renew",text:"Plus subscription expired."},on:{action:e.sessionStore.checkSiteBlockerFeatureDisabledAndOpenUpsell}}),e.manualToggleControlsVisible?t("app-button-row",[t("button",{staticClass:"button",attrs:{"data-test":"toggle-blocking"},on:{click:e.toggleBlockingActive}},[e._v(" "+e._s(e.sessionStore.active?"Stop":"Start")+" blocking websites ")])]):e._e()]},proxy:!0},{key:"body",fn:function(){return[t("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e.loaded?t("div",[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a group to get started","button-text":"Add Group","button-data-test":"new-group-empty"},on:{buttonClick:e.createNewGroup}}):[t("transition",{attrs:{name:"blocking-fade"}},[e.sessionStore.activeAndBlockingUrls?t("site-blocker-groups-blocking-banner",{class:{"toggle-visible":e.manualToggleControlsVisible}}):e._e()],1),t("site-blocker-groups-list")]],2):t("app-loading",{attrs:{"data-test":"groups-loading"}})],1)]},proxy:!0}])})}),[],!1,null,"85585224").exports;const z=S(e({name:"BaseDropdownConfirmation",components:{AppConfirmCancel:W},props:V,emits:["cancel","delete"],setup:()=>({AppConfirmCancelType:N})}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("app-confirm-cancel",e._g(e._b({attrs:{"data-test":"dropdown-confirm-delete"}},"app-confirm-cancel",e.$props,!1),e.$listeners))],1)}),[],!1,null,"7f4cb52f").exports,U=e({name:"SiteBlockerWebsitesListItem",components:{BaseDropdownConfirmation:z,FormEditableSpan:f,BaseForm:v,FavIcon:I,BaseIcon:m,BaseDropdownOption:D,BaseDropdown:R,ToggleSwitch:g},props:{website:{type:Object,required:!0},editing:{type:Boolean,default:!1},newWebsite:{type:Boolean,default:!1}},setup:()=>({viewStateStore:l(),websitesStore:w(),websitesDropdownRef:t(),inputNameRef:t(),inputUrlRef:t(),capture:s("capture")}),computed:{urlNameIfEmpty(){var e,t;if(this.website.name)return this.website.name;const s=null==(t=null==(e=this.website.url)?void 0:e.split("."))?void 0:t.at(-2);return s&&s.length>4&&A(s)||""},namePlaceholder(){return""===this.website.url||""===this.urlNameIfEmpty?"Website Name":this.urlNameIfEmpty},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===N.Dropdown}},mounted(){var e;this.newWebsite&&(null==(e=this.inputUrlRef)||e.focus())},methods:{toggleEnabled(){var e;if(this.website.enabled=!this.website.enabled,!this.newWebsite)return null==(e=this.capture)||e.call(this,"site blocker toggle website"),this.websitesStore.update(this.website.id,{enabled:this.website.enabled})},async editWebsite(e){var t,s,i,r,a;(!this.websitesStore.activeItem||!this.editing&&await(null==(t=this.viewStateStore)?void 0:t.setConfirmation({title:"Are you sure you want to edit?",description:"All unsaved changes will be lost!",type:N.Dropdown})))&&(null==(s=this.capture)||s.call(this,"site blocker edit website",{defaultKey:this.website.defaultKey}),this.websitesStore.editItem(this.website.id)),null==(i=this.websitesDropdownRef)||i.closeDropdown(),await o(),e?null==(r=this.inputNameRef)||r.focus():null==(a=this.inputUrlRef)||a.focus()},async deleteWebsite(){var e,t,s,i;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete?",type:N.Dropdown}))&&(null==(t=this.websitesDropdownRef)||t.closeDropdown(),await this.websitesStore.delete(this.website.id),null==(s=this.capture)||s.call(this,"site blocker delete website",{defaultKey:this.website.defaultKey}),(null==(i=this.websitesStore.activeItem)?void 0:i.id)===this.website.id&&this.websitesStore.clearActiveItem())},validateWebsite(){this.website.name=this.urlNameIfEmpty,this.website.validate()},async createNewWebsiteOrUpdateIfNameUrl(){var e,t;if(this.editing)return this.websitesStore.clearActiveItem(),this.newWebsite?(null==(e=this.capture)||e.call(this,"site blocker create website",{defaultKey:this.website.defaultKey}),this.websitesStore.create(this.website)):(null==(t=this.capture)||t.call(this,"site blocker update website",{defaultKey:this.website.defaultKey}),this.websitesStore.update(this.website.id,{name:this.website.name,url:this.website.url}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const H=e({name:"SiteBlockerWebsitesList",components:{SiteBlockerWebsitesListItem:S(U,(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("li",{staticClass:"site-blocker-websites-list-item app-list-item-lines-between",attrs:{"data-test":"websites-list-item"}},[i("base-form",{staticClass:"list-item-form",class:{editing:s.editing},attrs:{submit:s.createNewWebsiteOrUpdateIfNameUrl,validate:s.validateWebsite,"submit-button":!1,"submit-on-blur":!0}},[i("div",{staticClass:"list-item-top-row"},[s.editing?s._e():i("fav-icon",{staticClass:"url-favicon",attrs:{url:s.website.urlWithReplacedWildcard}}),i("form-editable-span",{ref:"inputNameRef",staticClass:"name-input",attrs:{editing:s.editing,name:"name-input",placeholder:s.namePlaceholder,"data-test":"websites-list-item-name-input"},nativeOn:{dblclick:function(e){return s.editWebsite(!0)}},model:{value:s.website.name,callback:function(e){s.$set(s.website,"name",e)},expression:"website.name"}}),i("toggle-switch",{attrs:{value:s.website.enabled,"data-test":"websites-list-item-toggle"},on:{click:s.toggleEnabled}}),i("base-dropdown",{ref:"websitesDropdownRef",attrs:{"data-test":"website-options-dropdown"},on:{toggle:s.clearConfirmationIfOpen}},[s.dropdownConfirmationVisible&&(null==(e=s.viewStateStore)?void 0:e.confirmationProps)?i("base-dropdown-confirmation",s._b({},"base-dropdown-confirmation",null==(t=s.viewStateStore)?void 0:t.confirmationProps,!1)):[i("base-dropdown-option",{attrs:{"data-test":"edit-website"},on:{click:function(e){return s.editWebsite(!1)}}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),s._v(" Edit ")],1),i("base-dropdown-option",{attrs:{"data-test":"delete-website"},on:{click:s.deleteWebsite}},[i("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),s._v(" Delete ")],1)]],2)],1),i("div",{staticClass:"list-item-bottom-row"},[i("form-editable-span",{ref:"inputUrlRef",staticClass:"url-input",attrs:{editing:s.editing,name:"url-input",placeholder:"URL","data-test":"websites-list-item-url-input"},nativeOn:{dblclick:function(e){return s.editWebsite(!1)}},model:{value:s.website.url,callback:function(e){s.$set(s.website,"url",e)},expression:"website.url"}})],1)])],1)}),[],!1,null,"8153e225").exports,BaseItemList:d},setup:()=>({websitesStore:w(),groupsStore:b()}),computed:{activeGroup(){return this.groupsStore.activeItem??new h({order:this.groupsStore.items.length})},websites(){return this.websitesStore.getWebsitesByGroup(this.activeGroup)},editingExistingWebsite(){return!!this.websitesStore.activeItem&&!!this.websitesStore.getWebsiteOrDefaultFromId(this.websitesStore.activeItem.id)}},methods:{createNewWebsite(){this.websitesStore.newItem(this.activeGroup)}}});const $=e({name:"SiteBlockerWebsites",components:{AppActionBanner:G,BaseDropdownConfirmation:z,BaseForm:v,AppEmpty:_,AppConfirmCancel:W,SiteBlockerWebsitesList:S(H,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("base-item-list",[e.websitesStore.activeItem&&!e.editingExistingWebsite?t("site-blocker-websites-list-item",{key:e.websitesStore.activeItem.id,attrs:{website:e.websitesStore.activeItem,editing:!0,"new-website":!0}}):e._e(),e._l(e.websites,(function(s){var i,o;return t("site-blocker-websites-list-item",{key:s.id,attrs:{website:(null==(i=e.websitesStore.activeItem)?void 0:i.id)===s.id?e.websitesStore.activeItem:s,editing:(null==(o=e.websitesStore.activeItem)?void 0:o.id)===s.id}})}))],2)}),[],!1,null,null).exports,BaseDropdownOption:D,BaseDropdown:R,FormEditableSpan:f,AppHeaderControl:x,AppView:c,AppHeader:u,BaseIcon:m},setup:()=>({viewStateStore:l(),groupsStore:b(),websitesStore:w(),sessionStore:k(),nameInputRef:t(),groupDropdownRef:t(),capture:s("capture"),AppHeaderCenterAlignment:P}),data:()=>({editingGroupName:!1}),computed:{activeGroup(){return this.groupsStore.activeItem??new h({order:this.groupsStore.items.length})},hasActiveItem(){return!!this.websitesStore.activeItem},empty(){return 0===this.websitesStore.getWebsitesByGroup(this.activeGroup).length},overlayConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===N.Overlay},dropdownConfirmationVisible(){var e,t;return(null==(t=null==(e=this.viewStateStore)?void 0:e.confirmationProps)?void 0:t.type)===N.Dropdown}},mounted(){this.viewStateStore&&(this.viewStateStore.beforeViewChange=()=>(this.editingGroupName||this.websitesStore.activeItemHasChanges)&&this.viewStateStore?this.viewStateStore.setConfirmation({title:"Are you sure you want to cancel?",description:"All unsaved changes will be lost!",type:N.Overlay,dashboardOverlay:!0}):Promise.resolve(!0))},destroyed(){var e;null==(e=this.viewStateStore)||e.resetBeforeViewChange(),this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{async goToGroups(){var e;await(null==(e=this.viewStateStore)?void 0:e.setActiveView(p.Groups))},createNewWebsite(){this.websitesStore.newItem(this.activeGroup)},async renameGroup(){var e,t;null==(e=this.groupDropdownRef)||e.closeDropdown(),this.editingGroupName=!0,await o(),null==(t=this.nameInputRef)||t.focus()},async deleteGroup(){var e,t,s;await(null==(e=this.viewStateStore)?void 0:e.setConfirmation({title:"Are you sure you want to delete this group?",type:N.Dropdown}))&&(null==(t=this.groupDropdownRef)||t.closeDropdown(),this.websitesStore.clearActiveItem(),null==(s=this.capture)||s.call(this,"site blocker delete group",{defaultKey:this.activeGroup.defaultKey}),await this.groupsStore.delete(this.activeGroup.id),await this.goToGroups())},updateGroupNameIfName(){var e;""!==this.activeGroup.name&&(this.editingGroupName=!1,null==(e=this.capture)||e.call(this,"site blocker update group",{defaultKey:this.activeGroup.defaultKey}),this.groupsStore.update(this.activeGroup.id,{name:this.activeGroup.name}))},clearConfirmationIfOpen(e){this.viewStateStore&&e&&(this.viewStateStore.confirmationProps=null)}}});const q=S(e({name:"SiteBlockerApp",components:{SiteBlockerWebsites:S($,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("app-view",{staticClass:"site-blocker-websites",scopedSlots:e._u([{key:"header",fn:function(){return[t("app-header",{scopedSlots:e._u([{key:"left",fn:function(){return[t("app-header-control",{on:{click:e.goToGroups}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/arrow-left"}})],1),t("base-form",{staticClass:"group-name-form",attrs:{submit:e.updateGroupNameIfName,"submit-button":!1,"submit-on-blur":!0}},[t("form-editable-span",{ref:"nameInputRef",staticClass:"name-input app-header-name",attrs:{placeholder:"Edit group",editing:e.editingGroupName,"data-test":"websites-group-name-input"},nativeOn:{dblclick:function(t){return e.renameGroup.apply(null,arguments)}},model:{value:e.activeGroup.name,callback:function(t){e.$set(e.activeGroup,"name",t)},expression:"activeGroup.name"}})],1)]},proxy:!0},{key:"right",fn:function(){var s,i;return[t("app-header-control",{attrs:{"data-test":"new-website"},on:{click:e.createNewWebsite}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-plus"}})],1),t("base-dropdown",{ref:"groupDropdownRef",attrs:{"data-test":"group-options-dropdown"},on:{toggle:e.clearConfirmationIfOpen}},[e.dropdownConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("base-dropdown-confirmation",e._b({},"base-dropdown-confirmation",null==(i=e.viewStateStore)?void 0:i.confirmationProps,!1)):[t("base-dropdown-option",{attrs:{"data-test":"edit-group"},on:{click:e.renameGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-edit"}}),e._v(" Rename ")],1),t("base-dropdown-option",{attrs:{"data-test":"delete-group"},on:{click:e.deleteGroup}},[t("base-icon",{staticClass:"icon",attrs:{src:"icon/delete"}}),e._v(" Delete ")],1)]],2)]},proxy:!0}])}),e.sessionStore.hasPermissions?e._e():t("app-action-banner",{attrs:{"action-text":"Grant permissions",text:"We need new permissions to handle blocking sites","data-test":"grant-permissions"},on:{action:function(t){return e.sessionStore.ensurePermissions(!0)}}})]},proxy:!0},{key:"body",fn:function(){return[e.empty&&!e.hasActiveItem?t("app-empty",{attrs:{title:"Add a website to get started","button-text":"Add Website","button-data-test":"new-website-empty"},on:{buttonClick:e.createNewWebsite}}):t("site-blocker-websites-list")]},proxy:!0},{key:"confirm",fn:function(){var s;return[e.overlayConfirmationVisible&&(null==(s=e.viewStateStore)?void 0:s.confirmationProps)?t("app-confirm-cancel",e._b({},"app-confirm-cancel",e.viewStateStore.confirmationProps,!1)):e._e()]},proxy:!0}])})}),[],!1,null,"b0d9aa43").exports,SiteBlockerGroups:T,AppPopup:a,AppViewSwitchDynamic:n},setup:()=>({groupsStore:b(),websitesStore:w(),viewStateStore:l()}),computed:{groupsViewActive(){return this.viewStateStore.activeViewId===p.Groups},websitesViewActive(){return this.viewStateStore.activeViewId===p.Websites}},destroyed(){this.groupsStore.clearActiveItem(),this.websitesStore.clearActiveItem()},methods:{checkSiteBlockerGroupViewOpen(){this.groupsViewActive?r.$emit("siteBlockerGroups:opened"):r.$emit("siteBlockerGroups:closed")}}}),(function(){var e,t,s=this,i=s._self._c;return s._self._setupProxy,i("app-popup",{attrs:{position:"bottom-right",region:"top-left",width:320,focused:s.viewStateStore.focused},on:{close:function(e){return s.viewStateStore.togglePopup(!1)}},nativeOn:{click:function(e){return s.viewStateStore.focus()}}},[i("app-view-switch-dynamic",{attrs:{"order-key":null==(t=null==(e=s.viewStateStore)?void 0:e.activeView)?void 0:t.order},on:{afterTransition:s.checkSiteBlockerGroupViewOpen}},[s.groupsViewActive?i("site-blocker-groups"):s._e(),s.websitesViewActive?i("site-blocker-websites"):s._e()],1)],1)}),[],!1,null,"c9f31be7").exports;export{q as default};