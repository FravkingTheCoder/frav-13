import{G as t,an as e,a as o}from"./dynamic-import-helper-Gh3O-GNF.js";import i from"./BaseIcon-CCkbWtl5.js";import{useSoundsViewStateStore as s,SoundsView as a}from"./soundsViewState-DDWq5mhi.js";import{u as r,S as l}from"./soundsPlayer-DcWIeeUN.js";import{S as p}from"./state-BIDDPgIj.js";import{S as n,a as u}from"./SoundsAudioCover-BJrM1ez0.js";import{n as c}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{S as d}from"./Slider-Ad2U5Vve.js";import{A as v}from"./AppDashOverlay-B-hAIwU7.js";import"./array-YYQw31d9.js";import"./main-DaaZyiXy.js";import"./Logger-DgjqecXr.js";import"./string-DLOjEt1Y.js";import"./ViewState-CalcjAWV.js";import"./appZStack-CXXM5U-T.js";import"./persistStore-7VuxlznA.js";import"./TabLeaderElection-8EqWBm0z.js";import"./focusModeState-D4CLHiD7.js";import"./LocalStorageStoreSyncedItem-CtVH-muf.js";import"./focusModeHelpers-CbYS8k-X.js";import"./reactiveCustomization-CaJFMm70.js";import"./VueBase-CYtBAh2Z.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-CCjyjLnb.js";import"./portal-vue.esm-BTKM9g0x.js";import"./PomodoroTimers-CyrfcuWH.js";import"./constants-BfBD_H-d.js";import"./focusModeViewState-B4fUYtwj.js";import"./pomodoroCompleted-PtbKLdeQ.js";import"./promisifiedChrome-YDDyAvDe.js";import"./login-kENE0gaj.js";import"./authService-DSVbm6Rd.js";import"./auth-D2YAhF74.js";import"./legacyUserMigration-DJj0rzI-.js";import"./enums-Cgv4i8uw.js";import"./migrateLegacyUserMessageHandler-FH_m4diU.js";import"./onboarding-Bdvt2O8-.js";import"./modal-D5eTjgvI.js";import"./IframeMessenger-Dbsts-JD.js";import"./globalKeyEventManager-DTQSIy-h.js";import"./SmoothReflow-44YdkIfk.js";import"./ResizeSensor-ZXOsDHeC.js";import"./allComponentsMounted-Dqy5K4Uf.js";const S=t({name:"SoundsVolumeIndicator",components:{BaseIcon:i},emits:["click"],setup:()=>({playerStore:r()}),computed:{icon(){const t=this.playerStore.muted?0:this.playerStore.globalVolume;return`icon/sounds/volume/volume${0===t?"-x":t<.33?"":t<.66?"-1":"-2"}`}},methods:{toggleMuted(){const t=0===this.playerStore.globalVolume?1:this.playerStore.globalVolume;this.playerStore.setGlobalVolume(t,!this.playerStore.muted)}}});const y=c(t({name:"SoundsAppDashPlayerControls",components:{AppDashOverlay:v,BaseIcon:i,SoundsVolumeIndicator:c(S,(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"sounds-volume-indicator",on:{click:function(e){return e.stopPropagation(),t.toggleMuted.apply(null,arguments)}}},[e("base-icon",{attrs:{src:t.icon,size:"1rem"}})],1)}),[],!1,null,"cc57e329").exports,Slider:d,SoundsPlayButton:n,SoundsAudioCover:u},setup:()=>({viewStateStore:s(),playerStore:r(),capture:e("capture"),globalVolumeAnalyticsCaptureTimeout:void 0,SoundsDataType:p}),computed:{activeItem(){return this.playerStore.activeItem},activeTabId(){return this.playerStore.activeTabId},activeItemViewVisible(){return this.viewStateStore.popupActive&&this.viewStateStore.activeViewId===a.Item},activeItemSkipSupported(){return!!(this.activeItem&&"externalType"in this.activeItem&&this.playerStore.isActiveTab)&&this.activeItem.externalType!==l.Track},volume:{get(){return this.playerStore.muted?0:this.playerStore.globalVolume},set(t){this.playerStore.setGlobalVolume(t,0===t),clearTimeout(this.globalVolumeAnalyticsCaptureTimeout),this.globalVolumeAnalyticsCaptureTimeout=setTimeout((()=>{var e,o,i,s;null==(s=this.capture)||s.call(this,"sounds global volume update",{volume:t,id:null==(e=this.activeItem)?void 0:e.id,type:null==(o=this.activeItem)?void 0:o.type,title:null==(i=this.activeItem)?void 0:i.title})}),300)}}},watch:{async activeTabId(t,e){t!==o&&""!==e&&(await this.viewStateStore.setActiveView(a.Library),this.viewStateStore.activeViewItemId="")}},created(){this.playerStore.refresh()},mounted(){m.on("globalEvent:spacebar",this.togglePaused)},destroyed(){m.off("globalEvent:spacebar",this.togglePaused)},methods:{async togglePaused(){var t;this.activeItem&&(await this.playerStore.toggleActiveItemPaused(),null==(t=this.capture)||t.call(this,"sounds paused toggle",{id:this.activeItem.id,type:this.activeItem.type,title:this.activeItem.title,paused:this.playerStore.paused}))},async openActiveItemView(){this.playerStore.activeItem&&!this.activeItemViewVisible&&(this.viewStateStore.activeViewItemId=this.playerStore.activeItem.id,await this.viewStateStore.setActiveView(a.Item),await this.viewStateStore.togglePopup(!0))},skip(){this.playerStore.skip()}}}),(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("transition",{attrs:{name:"fade-fast",duration:200}},[t.activeItem?e("app-dash-overlay",{staticClass:"sounds-app-dash-player-controls",attrs:{"overflow-visible":t.viewStateStore.popupActive},scopedSlots:t._u([{key:"overflow-content",fn:function(){return[t.activeItemSkipSupported?e("div",{staticClass:"icon-wrapper skip-icon",on:{click:function(e){return e.stopPropagation(),t.skip.apply(null,arguments)}}},[e("base-icon",{attrs:{"data-test":"dash-sounds-skip",src:"icon/media/skip-forward",size:"1rem"}})],1):t._e(),t.activeItem.type!==t.SoundsDataType.Spotify?e("div",{staticClass:"volume-content"},[e("sounds-volume-indicator"),e("slider",{attrs:{id:"globalSoundsVolume","data-test":"dash-sounds-volume-slider",min:0,max:1,interval:.05},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1):t._e(),t.activeItem.type!==t.SoundsDataType.Soundscapes||t.activeItemViewVisible?t._e():e("div",{staticClass:"icon-wrapper edit-item-icon",on:{click:function(e){return e.stopPropagation(),t.openActiveItemView.apply(null,arguments)}}},[e("base-icon",{attrs:{"data-test":"dash-sounds-adjust-tracks",src:"icon/apps/settings",size:"1rem"}})],1)]},proxy:!0}],null,!1,3354659607)},[e("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[e("sounds-audio-cover",{key:t.activeItem.id,attrs:{"icon-with-thumbnail":!1,icon:t.activeItem.icon??"",type:t.activeItem.type,"thumbnail-url":t.activeItem.thumbnailSrc,size:"34px"}})],1),e("sounds-play-button",{attrs:{id:t.activeItem.id,paused:t.playerStore.paused,loading:t.playerStore.loadingActiveItemPlayer,size:"var(--spacing-6)","data-test":"sounds-play-pause","data-paused":t.playerStore.paused?"true":"false"},on:{click:function(e){return e.stopPropagation(),t.togglePaused.apply(null,arguments)}}})],1):t._e()],1)}),[],!1,null,"1d42b6d4").exports;export{y as default};