const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdownCollection-BAeujOWH.js","assets/js/main-DaaZyiXy.js","assets/js/VueBase-CYtBAh2Z.js","assets/js/dynamic-import-helper-Gh3O-GNF.js","assets/js/array-YYQw31d9.js","assets/js/Logger-DgjqecXr.js","assets/js/string-DLOjEt1Y.js","assets/js/_commonjsHelpers-B3K3fdV-.js","assets/js/ClickOutside-DCLvi2fj.js","assets/js/pinia-CCjyjLnb.js","assets/js/portal-vue.esm-BTKM9g0x.js","assets/js/itemCollectionMixins-DFratNST.js","assets/js/reactiveCustomization-CaJFMm70.js","assets/js/namesMixin-vAeWzg7C.js","assets/js/itemDataServiceMixins-D2Ei-6Hc.js","assets/js/metricMetadata-DNyTfE06.js","assets/js/countdowns-q6nMDIs4.js","assets/js/metrics-gNtWZ-jH.js","assets/js/clocks-0rtjmFrI.js","assets/js/enums-Cgv4i8uw.js","assets/js/captureMixin-BByXqhGA.js","assets/js/metricCollection-DBdvDF07.js","assets/js/clockCollection-s5EbyTEP.js","assets/js/focusCollection-CV6Famoo.js","assets/js/addin-DZOZrGoe.js","assets/js/modal-D5eTjgvI.js","assets/js/tasksViewState-DusFQxW4.js","assets/js/ViewState-CalcjAWV.js","assets/js/appZStack-CXXM5U-T.js","assets/js/handlebarLoader-xbtIzd6B.js","assets/css/addin-DPDlCY_f.css","assets/js/linksViewState-CPrg2xTk.js","assets/js/constants-u23t4s7p.js","assets/js/links-B4VEy3PA.js","assets/js/compareObjects-BF7sSNEf.js","assets/js/tabsViewState-DeGtPs8L.js","assets/js/tabs-lcIYKcyN.js","assets/js/promisifiedChrome-YDDyAvDe.js","assets/js/focusModeViewState-B4fUYtwj.js","assets/js/focusModeState-D4CLHiD7.js","assets/js/LocalStorageStoreSyncedItem-CtVH-muf.js","assets/js/PomodoroTimers-CyrfcuWH.js","assets/js/persistStore-7VuxlznA.js","assets/js/constants-BfBD_H-d.js","assets/js/pomodoroCompleted-PtbKLdeQ.js","assets/js/login-kENE0gaj.js","assets/js/authService-DSVbm6Rd.js","assets/js/auth-D2YAhF74.js","assets/js/legacyUserMigration-DJj0rzI-.js","assets/js/migrateLegacyUserMessageHandler-FH_m4diU.js","assets/js/onboarding-Bdvt2O8-.js","assets/js/siteBlockerGroups-9WPnbAn4.js","assets/js/constants-Dqx3dGLK.js","assets/js/siteBlockerSession-omvO_qAK.js","assets/js/soundsPlayer-DcWIeeUN.js","assets/js/state-BIDDPgIj.js","assets/js/TabLeaderElection-8EqWBm0z.js","assets/js/IframeMessenger-Dbsts-JD.js","assets/js/soundsViewState-DDWq5mhi.js"])))=>i.map(i=>d[i]);
import{u as e,d as t,w as s,M as a,e as i,ax as o}from"./dynamic-import-helper-Gh3O-GNF.js";import{A as n,d as l,M as r,C as c,V as d,B as u}from"./focusModeState-D4CLHiD7.js";import{computedObjectSettings as p,persistentObjectSettings as f}from"./reactiveCustomization-CaJFMm70.js";import{_ as b}from"./main-DaaZyiXy.js";import{a as _}from"./PomodoroTimers-CyrfcuWH.js";import{p as h}from"./persistStore-7VuxlznA.js";import{b as w}from"./constants-BfBD_H-d.js";const V={countdowns:()=>g(b((()=>import("./countdownCollection-BAeujOWH.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]))),metrics:()=>g(b((()=>import("./metricCollection-DBdvDF07.js").then((e=>e.b))),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,14,11,12,13,15,16,17,18,19,20]))),clocks:()=>g(b((()=>import("./clockCollection-s5EbyTEP.js")),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,14,11,12,13,15,16,17,18,19,20]))),focus:()=>g(b((()=>import("./focusCollection-CV6Famoo.js")),__vite__mapDeps([23,2,3,4,1,5,6,7,8,9,10,11,12,13,24,25,19,26,27,28,29,30]))),linksViewStateStore:()=>g(b((()=>import("./linksViewState-CPrg2xTk.js")),__vite__mapDeps([31,27,3,4,1,5,6,28,32]))),linksStore:()=>g(b((()=>import("./links-B4VEy3PA.js").then((e=>e.l))),__vite__mapDeps([33,3,4,1,5,6,32,34,9]))),tabsViewStateStore:()=>g(b((()=>import("./tabsViewState-DeGtPs8L.js")),__vite__mapDeps([35,27,3,4,1,5,6,28]))),tabsStore:()=>g(b((()=>import("./tabs-lcIYKcyN.js").then((e=>e.t))),__vite__mapDeps([36,3,4,1,5,6,37,25,19]))),focusModeViewStateStore:()=>g(b((()=>import("./focusModeViewState-B4fUYtwj.js")),__vite__mapDeps([38,3,4,1,5,6,27,28,39,40,12,2,7,8,9,10,41,42,43]))),focusModeSessionStore:()=>g(b((()=>Promise.resolve().then((()=>S))),void 0))};async function g(e){return(await e).default}const y={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const s=(await b((async()=>{const{default:e}=await import("./pomodoroCompleted-PtbKLdeQ.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([44,3,4,1,5,6,42,39,40,41,12,2,7,8,9,10,37,45,46,47,48,19,49,50,25]))).default();return await e((()=>s.loaded)).toBe(!0),s.playing||await s.switchTo(_.Focus),t.delay(n).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await t.delay(n),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await b((async()=>{const{default:e}=await import("./pomodoroCompleted-PtbKLdeQ.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([44,3,4,1,5,6,42,39,40,41,12,2,7,8,9,10,37,45,46,47,48,19,49,50,25]))).default();await e((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0,playSounds:!1}),t.countDownTimerLength&&(t.countDownTimerLength=null)}},siteBlocker:{enable:async()=>{const e=(await b((async()=>{const{default:e}=await import("./siteBlockerGroups-9WPnbAn4.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([51,3,4,1,5,6,52,34]))).default(),t=(await b((async()=>{const{default:e}=await import("./siteBlockerGroups-9WPnbAn4.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([51,3,4,1,5,6,52,34]))).default();e.refresh(),t.refresh();return(await b((async()=>{const{default:e}=await import("./siteBlockerSession-omvO_qAK.js");return{default:e}}),__vite__mapDeps([53,3,4,1,5,6,40,51,52,34,37,39,38,27,28,12,2,7,8,9,10,41,42,43,44,45,46,47,48,19,49,50,25]))).default().active},disable:async({enableResult:e,focusing:t})=>{if(t)return;(await b((async()=>{const{default:e}=await import("./siteBlockerSession-omvO_qAK.js");return{default:e}}),__vite__mapDeps([53,3,4,1,5,6,40,51,52,34,37,39,38,27,28,12,2,7,8,9,10,41,42,43,44,45,46,47,48,19,49,50,25]))).default().toggleActive(!!e)},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1,get unsupported(){return t.isPwa()}},soundscapes:{enable:async()=>{var e;const t=(await b((async()=>{const{default:e}=await import("./soundsPlayer-DcWIeeUN.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([54,42,3,4,1,5,6,55,40,56,39,38,27,28,12,2,7,8,9,10,41,43,44,37,45,46,47,48,19,49,50,25,57,58]))).default();return t.refresh(),{id:null==(e=t.activeItem)?void 0:e.id,paused:t.paused}},disable:async({enableResult:e,focusing:t})=>{if(t||!e)return;const s=e,a=(await b((async()=>{const{default:e}=await import("./soundsPlayer-DcWIeeUN.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([54,42,3,4,1,5,6,55,40,56,39,38,27,28,12,2,7,8,9,10,41,43,44,37,45,46,47,48,19,49,50,25,57,58]))).default();if(s.id&&!s.paused)a.play(s.id);else if(s.id){const e=a.getItem(s.id);if(!e)return;a.update({activeItem:e,paused:!0})}},shouldEnableOnResume:()=>!0},tabStash:{enable:()=>{},disable:async({enableResult:e,inactive:a})=>{var i;if(a)return;const o=(await V.tabsStore())();if(o.loaded&&!o.loading||(await new Promise((e=>{s((()=>o.loaded),e),o.loading||o.refresh()})),await t.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(e=null==(i=o.getItems[0])?void 0:i.id),"string"==typeof e){const t=o.getItemById(e);t&&await o.restoreSession(t)}},get unsupported(){return t.isSafari()||t.isPwa()}}},A=["siteBlocker","soundscapes","tabStash"];let E;const I=h((({loadedRef:e,updateAsync:s})=>i("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:t.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:e=>!e.stop,loaded:()=>e.value,capacityLimitInfoForToday(){const e=this.capacityLimitInfo,s=m.models.date.get("date"),a=t.getDateOnly(s);return e.date!==a?{date:a,msUsed:0}:e},msUntilOverCapacityLimit(){const e=c,t=this.capacityLimitInfoForToday.msUsed,s=m.models.date.get("seconds").getTime();return e-(t+(this.focusModeActive?s-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const e=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<e-r},totalTimeFocusedIncludingCurrentSession(){const e=m.models.date.get("date").getTime();let t=this.totalTimeFocused;return this.focusModeActive&&(t+=e-this.start),Math.max(t,0)}},actions:{async update(e){await s(e)},async stopAndSaveFocusMode(){const e=this.capacityLimitInfoForToday,s=Date.now(),a=s-this.start;e.msUsed+=a,0!==t.nightsBetween(new Date(s),new Date(this.start))&&e.msUsed>t.MS_IN_1_HOUR&&(e.msUsed=0);const i=this.totalTimeFocused+a;await this.update({stop:s,capacityLimitInfo:e,totalTimeFocused:i,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(e){const t=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:e,capacityLimitInfo:t}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:e=3e3}={}){this.focusModeActive&&(clearTimeout(E),E=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),e))},async disableAppsBeforeStop(e){for(const t of A){const s=y[t];s.unsupported||await s.disable({enableResult:this.appActivationData[t],inactive:e})}}}})),{mode:a.Cache,syncAutomatically:!0});(async()=>{const t=I();await e((()=>t.loaded)).toBe(!0),l.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const S=Object.freeze(Object.defineProperty({__proto__:null,default:I,useFocusModeSessionStore:I},Symbol.toStringTag,{value:"Module"})),T=()=>{const e=p.focusModeSettings,t=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);return e.apps={...t.apps,...e.apps},{...t,...e}},v=()=>f,D=async(e,t,s)=>{const a=v().focusModeSettings;a.apps[e]||(a.apps[e]={enabled:!1}),a.apps[e][t]=s,v().focusModeSettings=a,I().focusModeActive&&(await(async(e,t)=>{const s=I(),a=s.appActivationData||{};if(t){const t=await y[e].enable();if(null==t)return;a[e]=t}else await y[e].disable({enableResult:a[e],focusing:!0}),(y[e].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete a[e];await s.update({appActivationData:a})})(e,s),L())},L=()=>{const e=T(),t={notesVisible:e.notesVisible,todoVisible:e.todoVisible,quoteVisible:!1,siteBlockerVisible:e.apps.siteBlocker.enabled,soundscapesVisible:e.apps.soundscapes.enabled,tabsVisible:e.apps.tabStash.enabled,searchVisible:!1,launchpadVisible:!1,focusModeVisible:!0,askAiVisible:e.askAiVisible,linksVisible:e.linksVisible,metricVisible:e.metricsVisible,countdownVisible:e.countdownsVisible,multiClockVisible:e.worldClocksVisible,focusInsightVisible:e.focusInsightVisible,weatherVisible:!1,calendarVisible:e.calendarVisible,dashAppTextLabels:w.Hover};o(t)},M=()=>{m.widgetManager.addVueAppExemption(d,"focusMode"),m.widgetManager.addAppExemption(u,"focusMode")},O=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(d,"focusMode"),m.widgetManager.removeAppExemption(u,"focusMode")},R=()=>{o({soundscapesVisible:!!m.conditionalFeatures.featureEnabled("plus")&&null,tabsVisible:!(!m.conditionalFeatures.featureEnabled("tab-stash-degraded")&&!m.conditionalFeatures.featureEnabled("plus"))&&null,notesVisible:null,todoVisible:null,quoteVisible:null,siteBlockerVisible:null,searchVisible:null,launchpadVisible:null,focusModeVisible:null,askAiVisible:null,linksVisible:null,metricVisible:null,countdownVisible:null,multiClockVisible:null,focusInsightVisible:null,weatherVisible:null,calendarVisible:null,dashAppTextLabels:null})};export{M as a,R as b,y as c,v as d,D as e,S as f,T as g,V as i,O as r,L as s,I as u};